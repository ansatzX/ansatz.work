---
{"dg-publish":true,"permalink":"/slides/literature-report-first-quant-2/","dgPassFrontmatter":true}
---


# LiteratureReport 

**Speaker** : Cunxi Gong

Date: 2025-04-18


---

# Review 1

**Basic problem**: how to treat fermions. 

In second quantization, fermions are treated by defining anticommutation relations. To make qubits that fulfill these relations, a transformation such as the Jordan–Wigner or Bravyi–Kitaev transformation has to be performed.

In first quantization, the wave functions are antisymmetrized. In this paper, we used ancillae called register a to antisymmetrize the wavefunction mapped onto qubits.

Contents:

1. different quantization method and their scale
2. how to simulate chemistry reaction 
3. how to prepare antisymmetric states and their circuits



---
# Today's Paper

![first quant part 2|482x163](/img/user/pics/LiteratureReport： first-quant-2-1744915514699.webp)

[paper](zotero://open-pdf/library/items/XYPFG4LA?page=1)
This paper is mainly about how to write a quantum simulator with Qiskit to meet the minimum need of chemistry reaction.

Actually, this is exactly about how to build a circuit generator program.

---

# Programming Issues and Solutions

## Issues
1. the need to avoid interface mismatches when constructing a large circuit, which involves the decomposition of it into smaller subcircuits hierarchically.

2. provision of a higher-level programming interface for implementing basic arithmetic formulas from low-level quantum computer instructions.

## Solutions

1. introduce design pattern for sub-circuit invocation

2. apply AST (abstract syntax tree) [ast slides](https://courses.cs.washington.edu/courses/cse401/08wi/lecture/AST.pdf)[python ast](https://docs.python.org/3/library/ast.html)

Quantum instructions are generated by using AST. It simplify the coding task.

--- 

**Doubling the memory** size for a quantum computer simulator **adds only one simulated qubit*. 

Using a **cluster** for a quantum computer simulator would **add several simulated qubits** compared with those of a single computer.

---
# Formulation of Chem-Reaction



1. Representation of the Wave Function [paper](zotero://open-pdf/library/items/XYPFG4LA?eq=1)
2. Preparation of the Initial Wave Function
3. Preparation of Antisymmetric States
4. Preparation of a Mixed State of Energy Configurations.
5. Time Evolution
## details 

### Wave Function
The integer values in these registers are transformed from discretized positional coordinates into momentum coordinates (or vice versa) by using an inverse Fourier (or Fourier) transform.
![LiteratureReport： first-quant-2-1744941980114.png](/img/user/pics/LiteratureReport%EF%BC%9A%20first-quant-2-1744941980114.png)
![LiteratureReport： first-quant-2-1744942024744.png](/img/user/pics/LiteratureReport%EF%BC%9A%20first-quant-2-1744942024744.png)
in the momentum representation,

![LiteratureReport： first-quant-2-1744942046553.png](/img/user/pics/LiteratureReport%EF%BC%9A%20first-quant-2-1744942046553.png)
### Initial Wave Function
![LiteratureReport： first-quant-2-1744942456056.png](/img/user/pics/LiteratureReport%EF%BC%9A%20first-quant-2-1744942456056.png)
### Antisymmetric States
1. preparation of the ancillae to the k-sequence state, or the $ k_{\Sigma}  state
2. shuffling.

 ![LiteratureReport： first-quant-2-1744942625168.png](/img/user/pics/LiteratureReport%EF%BC%9A%20first-quant-2-1744942625168.png)

![LiteratureReport： first-quant-2-1744942644540.png](/img/user/pics/LiteratureReport%EF%BC%9A%20first-quant-2-1744942644540.png)
![LiteratureReport： first-quant-2-1744942683049.png](/img/user/pics/LiteratureReport%EF%BC%9A%20first-quant-2-1744942683049.png)
### Mixed State of Energy Configurations.

thermal states

## Time Evolution
Suzuki−Trotter decomposition.
![LiteratureReport： first-quant-2-1744950902903.png](/img/user/pics/LiteratureReport%EF%BC%9A%20first-quant-2-1744950902903.png)

with B.O.
![LiteratureReport： first-quant-2-1744950950590.png](/img/user/pics/LiteratureReport%EF%BC%9A%20first-quant-2-1744950950590.png)


---
# Designed Circuits

## parameters

${d}$ dimension of coordinates  
$n_{1}$ number of bits per coordinate for a dimension
$L$ length of simulation space along one axis 
$\eta$ number of electrons 
$L_n$ number of nuclei 
$N_{E}$ number of configurations in the mixed state  
$\phi_{c, i, d, x}$ array holding data for electron orbital $\phi_{i}$indexed by [energy  configuration, orbital, dimension, position]
$\Psi_{c, i, d, X}$ array holding data for nucleus orbital $\Psi_{i}$ 
$\delta t$ step of time evolution for an electron  
$T_{N}$ number of nucleus-level iteration steps 
$T_{e}$ number of electron-level iteration steps within one nucleus-level  iteration step


---
# Design Examples

Four simulator configurations: 
1. a basic one dimensional configuration with a 3-bit coordinate, one electron, one nucleus, and one initial wave function (d = 1, n = 3, η = 1, Ln = 1, NE = 1)
2. the first example with two dimensions instead of one (d = 2, n = 4, η = 1, Ln = 1, NE = 1)
3. a one-dimensional configuration with four electrons (d = 1, n = 2, η = 4, Ln = 1, NE =1) 
4. a one-dimensional configuration with two electrons, with four wave functions in the initial mixed state (d = 1, n = 2, η = 2, Ln = 1, NE = 4).

---
# Example 1

![LiteratureReport： first-quant-2-1744945959575.png](/img/user/LiteratureReport%EF%BC%9A%20first-quant-2-1744945959575.png)

![LiteratureReport： first-quant-2-1744950827491.png](/img/user/pics/LiteratureReport%EF%BC%9A%20first-quant-2-1744950827491.png)

[paper fig1:overall circuit](zotero://open-pdf/library/items/XYPFG4LA?page=6)

uses a simple absolute value gate instead of a sequence of gates to calculate the norm for the distance between the electron and the nucleus.

The top six lines are qubits for the coordinate bits.
The lower 13 lines with labels tmpn are temporary qubits.

state preparation gate, $Ψ_{sd}$,

the circuit consists of nested time-evolution loops. Outer loop operates with nucleus scale time steps and the inner loop operates with electron scale time steps.

The first gate inside the inner loop is the $ \theta_{ep}  gate, which calculates the electron−electron and electron− nucleus potential energy terms

$n-QFT^†$. transform position representation into a momentum representation.

electron kinetic energy (K.E.) time evolution gate, $Θ_{ek}$, which alters the phases according to the coordinates in p-space
nQFT,

[paper fig2: preparation](zotero://open-pdf/library/items/XYPFG4LA?page=6)
$Ψ_{sd}$, is shown in Figure 2A.

with one eletron, the permutations to build the Slater determinant are not present. 

The three-bit state embedding gate, emb(3), is applied to each of the two coordinate registers, e0x and n0x

recursive structures of those two gates are illustrated in Figure 2C through H.

[paper fig3](zotero://open-pdf/library/items/XYPFG4LA?page=7)
Electron P.E. time evolution gate, $Θ_{ep}$

using 19 qubits

IQFT is independently applied to each of the coordinate bit sets.

[paper fig4](zotero://open-pdf/library/items/XYPFG4LA?page=8)
K.E. time evolution gate, Θek, is shown in Figure 4A.
nQFT† in 4B

---
# example 2
with two-dim H
[paper fig5](zotero://open-pdf/library/items/XYPFG4LA?page=9)
The overall bit count is 36, number of coordinate qubits is 8,
## gates
ssub (signed subtraction) gates
ssquare (signed square) gate for the x and y coordinates. 
uaddv (unsigned adder) gate, 
sqrt (square root) gate.
udiv (unsigned divide) gate takes the inverse of the result of the sqrt gate.


witth same overall circuit 

difference is $Θ_{ep}$ for 2-D coordinates

---
# example 3

[paper fig6: overall circuit](zotero://open-pdf/library/items/XYPFG4LA?page=10)
a model with multiple electrons and introduces anti-symmetrization

a one-dimensional model with four electrons and one nucleus, using two-bit coordinates, beryllium atom

The total number of qubits is 28

[paper fig7](zotero://open-pdf/library/items/XYPFG4LA?page=11)
The SD gate, Ψsd, is shown in Figure 7A.
unary-coded permutation gate $S_{u}.$

A gate sequence of XZX is inserted before the shuffling gates when η is even to cancel an artificial global phase π added in the circuit
The input to XZX is |0⟩, so the XZX sequence adds a global phase of π.


[paper fig9](zotero://open-pdf/library/items/XYPFG4LA?page=13)
The unary-coded conditional shuffling gate

each shuffle gate adds a global phase of π. When η is odd, an even number of π phases are added so they cancel out. In contrast, when η is even, an odd number of π phases are added so the phase remains.

just for debugging since global phase does not affect the result of the circuit

[paper fig8](zotero://open-pdf/library/items/XYPFG4LA?page=12)
sequence preparation gate kuΣ for k = 2, 3, and 4 is shown in Figure 8.

A CNOT gate follows each $R_{y}$ gate.

so, only one of the output qubits is |1⟩; the other qubits are |0⟩.

[paper fig10](zotero://open-pdf/library/items/XYPFG4LA?page=14)
Figure 10 shows the binary-coding-based permutation gate $S_b$.

[paper fig11](zotero://open-pdf/library/items/XYPFG4LA?page=14)
Figure 11 shows the binary-coded sequence preparation gate $kb_{Σ}(s, k)$

[paper fig12](zotero://open-pdf/library/items/XYPFG4LA?page=15)
Figure 12 shows binary-coded conditional shuffling gates, $σ_b(k)$


---
# Example 4
a model of excitation, thereby making chemical reactions possible. 
a model with one dimension, 2-bit coordinates, two electrons, one nucleus, and four sets of initial wave functions.
[paper fig13](zotero://open-pdf/library/items/XYPFG4LA?page=16)
general state preparation gate, Ψg, (Figure 13 A
The configuration preparation gate, ρ (Figure 13B)



---
# Evaluation of the Qubit Count for Different Model Sizes

[paper fig14](zotero://open-pdf/library/items/XYPFG4LA?page=16)
using Born−Oppenheimer approximation, the qubits used to store the nuclei coordinates are omitted,



---

# DESIGN OF THE IMPLEMENTATION

1. Program Structure
2. Arithmetic Component
3. Qubit Heap Component
4. AST Component
5. Scope Class
6. Simulator Gate Component


##  Details

### Program Structure

four component
1. **arithmetic component**: provides functions to build circuits
2. **qubit heap component**: maintains a heap or pool
3. **abstract syntax tree component**: provides node classes for a tree structure that represents a calculation of a formula
4. **simulator gates component**: provides a high-level interface on top of the arithmetic component.

[paper fig15](zotero://open-pdf/library/items/XYPFG4LA?page=16)

###  Scope Class
to create the node objects and keep track of them.
scope object provides methods to create leaf nodes

 
### Simulator Gate Component

top-level component of the structure of the simulator program

1. Wave Function Preparation Gates.
2. Time Evolution Gates.

---
# Verification/Testing 

The Aer simulator implements several simulation methods; the  basic “statevector” method was used.7 This method allows inspection of the state vector data, which is impossible with an actual quantum computer.

1. Verification of Arithmetic Gates
2. Verification of Abstract Syntax Trees.
3. Verification of Time-Evolution Calculation
4. Verification of Initial State Preparation

## Details

### Arithmetic Gates
The input data used in the code in the test suite is a single state, not a superposition because when an unexpected output is produced due to a bug

we prepared the input qubits in a superposition of all possible input values. The program then ran the circuit on a simulator and extracted the state vector from the simulator. We checked each term of the state vector whether it has a nonzero amplitude


From the superposition state, we extracted only the values which is bigger than  ε,which ε is chosen to be large enough to filter out noise entries.

[paper fig 24](zotero://open-pdf/library/items/XYPFG4LA?page=20) and [paper fig25](zotero://open-pdf/library/items/XYPFG4LA?page=20) plot resluts

### Abstract Syntax Trees.
tested by creating a minimal tree for each operation type and having the tree generate the quantum circuit, which was then run, and the resulting state vector was inspected.

### Time-Evolution Calculation
tested by running them on tailored wave functions

verified the correctness of the circuit by inspecting the phase shift of each element of the resulting state vector.
### Initial State Preparation

general-state preparation gate, Ψg. This gate has two subcomponents: the SD preparation gate, $Ψsd$, and the configuration preparation gate, $ρ$.

Ψsd gate is further decomposed into the state embedding gate, emb(n), and the permutation gate,

Ψsd gate inspecting the state vector by extracting the wave function entangled with each value of register set a. Permutation gate make amplitude values  inverted.

---
# Final

Heap component that we designedwas confirmed to be effective. 
The simulator circuit has the structure shown in [paper fig 23](zotero://open-pdf/library/items/XYPFG4LA?page=19), which illustrates more than 15 examples of gate usage. Each gate invocation is accompanied by target qubit passing, where the temporary qubit count must be determined. The ability to calculate the number of temporary qubits automatically was found valuable.

## CONCLUSIONS

We have implemented and verified a quantum circuit generator program that can construct grid-based first quantization chemical simulator circuits.

### limitations
1. required qubit count exceeded the treatable one.
2. built basic circuit, although various improvements have been proposed.
3. had not yet evaluated gate count or circuit depth in our software.